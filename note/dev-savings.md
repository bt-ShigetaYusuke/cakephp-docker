# app

pocketmoney

# Documents

- 画面遷移図
- テーブル定義書
- 変数定義書
- フローチャート
- テストケース

# 目的

- 毎月の「使える金額」を把握して、無理なく貯金する
- 支出を記録してお金の使い方を可視化する

# 機能

- 月替わり処理の自動化
  - 月が変わったら残高更新＆月支出リセット
- 履歴のレコードは画面側で削除可能

## 残高管理

- 「使える金額」の現在値
- 残高初期値 = 初期稼働時の値
- 翌月になると「前月残高 + デフォルト値」が自動加算される
  - 翌月 1 日 0:00
  - Asia/Tokyo 基準で月境界を切る
- 計算式 : 残高 = 残高 - 支出
- 前月残高に加算されるデフォルト値は設定から変更可能

## 支出管理

- 支出
  - 手動入力（入力フォームから登録）
  - 登録時に
    - 月支出に加算
    - 残高から減算
    - 履歴に記録
- 月支出
  - 当月の合計使用額
  - 翌月初にリセット（0 円に戻る）
    - リセットの実体は「当月支出集計が 0 に戻る」ことで、履歴自体は消さない。

## カテゴリ管理

- カテゴリ
  - 支出目的を分類（食費、交通費、趣味）など
  - ユーザーが自由に追加・削除可能

## 履歴

- 支出登録時に自動更新
- 表示内容
  - 日付
  - カテゴリ
  - 支出金額
  - 登録後の残高
- 並び順 : 新しい順
- 履歴レコード削除可能（むずそうなので削除は現在月のみにする）
  - 削除時の挙動
    - 残高 +=削除レコードの支出金額
    - 月支出 -= 削除レコードの支出金額

## 履歴レコード削除機能

- 通常の削除では危険
  - データとしては支出が出た事実が消えるから
  - いつ誰が何で消したかが追えないから
  - 将来、履歴とキャッシュの整合が崩れる原因になるから
- 「取消仕訳」というやり方がある
  - 物理削除はせず、「取消レコードを追加」する
  - 支出 -1000 円だった事実も残るし、それを取り消す事実も残るやり方、で結果的には残高は元に戻ると。
  - 「データは消さないで、帳簿で整合を取る」って感じ。

# 画面

## 支出画面

- 目的 : 支出を登録する
- 表示要素 :
  - フォーム
    - 支出金額入力
    - カテゴリ選択（プルダウン）
    - 登録ボタン
  - 当月支出合計の表示

## 残高画面

- 目的 : 現在の使える金額を確認
- 表示要素 :
  - 現在の残高
  - 貯金予定額（前月残高に加算されるデフォルト値 - 当月支出合計）の表示
    - マイナスの場合は「0」表示

## 履歴画面

- 目的 : 過去の支出を確認
- 表示要素 :
  - テーブル形式
    - 日付
    - カテゴリ
    - 支出
    - 残高
  - 月別フィルター、カテゴリ別検索可能

## カテゴリ一覧画面

- 目的 : カテゴリの管理
- 表示要素 :
  - 登録済みカテゴリ一覧
  - 編集 / 削除ボタン（各カテゴリごと）

## カテゴリ追加画面

- 目的 : カテゴリを新規追加
- 表示要素 :
  - カテゴリ名入力フォーム
  - 登録ボタン

# テーブル設計

テーブル設計は「何を保存して、どう守るか」を決める作業
